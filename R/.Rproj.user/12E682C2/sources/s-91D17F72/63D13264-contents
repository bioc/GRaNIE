
# Workflow draft for GRN R package

# All parameters are stored in the object and can be set via a function. Also allow overriding in the functionc all?

GRN = initializeGRN(parameters)
GRN = addData(GRN, countsATAC, data = "atac", normalization = "DESeq_sizeFactor")
GRN = addData(GRN, countsRNA, data = "rna", normalization = "quantile")

GRN = filterData(GRN, data = "atac", type = "min", threshold = 5)

GRN = addTFBS(GRN, ) # should this overlapn with the peaks automatically?

GRN = correlateATAC_RNA(GRN, addPermutedData = TRUE)

# Optional step: Run the AR classification
GRN = classifyTFs(GRN)

GRN = addGenes(GRN, neighborhoodSize = 250000, geneTypes = c("lincRNA", "protein_coding"))

GRN = filterGRN(GRN, TF_peak_FDR = 0.2, peak_gene_FDR = 0.1, name = "filter1")

# QC plots can be generated with various helper functions
plot_GRN_connectionSummary(GRN)
plot_networkConnectionSummary(GRN)

# Extract data out of object: From ATAC to RNA to (filtered) peaks to stats objkects etc
data = extractData(GRN, type = "bla")


visualizeGRN()

Store both RNA and ATAC as SummarizedExperiment or RangedSummarizedExperiment object, or whole GRN as one?